<div class="row">
  <div class="col-12">
    <nb-card>
      <nb-card-header *ngIf="patient">
        <div class="row" *ngIf="editMode; else newOrderTitle">
          <div class="col-9">
            <h2>
              Edit self-monitor blood glucose order
            </h2>
          </div>
          <div class="col-3 text-right">
            <button nbButton status="danger" (click)="deleteServiceRequest()">
              <nb-icon class="icon" icon="trash" pack="eva"></nb-icon>
              Delete
            </button>
          </div>
        </div>
        <ng-template #newOrderTitle>
          <div class="row">
            <div class="col-12">
              <h2>
                <ng-container i18n>New self-monitor blood glucose order for</ng-container>
                {{ patientName }}
              </h2>
            </div>
          </div>
        </ng-template>
      </nb-card-header>
      <nb-card-body>
        <form [formGroup]="serviceForm" (ngSubmit)="submitForm()" class="form-horizontal">

          <app-duration-form #durationForm [form]="serviceForm"></app-duration-form>

          <app-week-timing-form #weekTimingForm [form]="serviceForm"></app-week-timing-form>

          <div class="form-group row">
            <label for="drug-instructions" class="col-form-label col-sm-3 form-control-label" i18n>Instructions</label>
            <div class="col-sm-9">
              <textarea nbInput fullWidth id="drug-instructions" [formControl]="instructionsControl"></textarea>
            </div>
          </div>
          <div class="mt-4 form-group row">
            <div class="col-6 col-sm-8">
              <button type="button" nbButton status="basic" (click)="goBack()"
                      [disabled]="formStatus === formStatusType.loading || formStatus === formStatusType.success">
                <ng-container i18n>Cancel</ng-container>
              </button>
            </div>
            <div class="col-6 offset-sm-1 col-sm-3 text-right">
              <button type="submit" nbButton status="success"
                      [disabled]="formStatus === formStatusType.loading || formStatus === formStatusType.success">
                <ng-container i18n>Save</ng-container>
              </button>
            </div>
            <div class="col-12 mt-3 text-center" *ngIf="formStatus === formStatusType.error">
              <nb-alert accent="danger">
                <span i18n>There was a problem saving the record</span>
              </nb-alert>
            </div>
            <div class="col-12 mt-3" *ngIf="formStatus === formStatusType.success">
              <nb-alert accent="success">
                <div class="row">
                  <div class="col-7">
                    <span i18n>The record has been saved</span>
                  </div>
                  <div class="col-5 text-right">
                    <button type="button" nbButton status="success" (click)="goBack()" i18n="Return button">Return
                    </button>
                  </div>
                </div>
              </nb-alert>
            </div>
          </div>
        </form>
      </nb-card-body>
    </nb-card>
  </div>
</div>
